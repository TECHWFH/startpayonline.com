<!DOCTYPE html>
<html lang="hi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡§™‡•ç‡§≤‡•â‡§ü ‡§ï‡•ç‡§∑‡•á‡§§‡•ç‡§∞‡§´‡§≤ ‡§î‡§∞ ‡§≤‡§æ‡§ó‡§§ ‡§ï‡•à‡§≤‡§ï‡•Å‡§≤‡•á‡§ü‡§∞</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f0f4f8;
            color: #333;
        }
        .container {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
        }
        .sidebar, .calc-section {
            background-color: white;
            padding: 20px;
            border-radius: 8px;
            border: 1px solid #ddd;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
        }
        .sidebar {
            flex: 1;
            min-width: 280px;
        }
        .main-content {
            flex: 2.5;
            min-width: 500px;
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
        }
        h1, h2 {
            color: #b71c1c; /* Changed to dark red */
            font-weight: bold;
            border-bottom: 2px solid #ffcdd2; /* Changed to light red */
            padding-bottom: 10px;
            margin-top: 0;
        }
        table {
            width: 100%;
            border-collapse: collapse;
        }
        th, td {
            padding: 12px 10px;
            border: 1px solid #ddd;
            text-align: left;
        }
        th {
            background-color: #ffcdd2; /* Changed to light red header */
            font-weight: bold;
        }
        tr:nth-child(even) {
            background-color: #f9f9f9;
        }
        .total-row {
            font-weight: bold;
            background-color: #d1d5db; /* Gray background for total rows */
        }
        .final-total-row {
            font-weight: bold;
            background: linear-gradient(to right, #0000FF, #FF0000);
            color: #ffffff; /* Changed to White for contrast */
        }
        /* Custom styles for the new WhatsApp button */
        .whatsapp-button {
            display: inline-flex;
            align-items: center;
            background-color: #b71c1c; /* Changed to dark red */
            color: white;
            padding: 12px 20px;
            font-size: 16px;
            border: none;
            border-radius: 8px;
            text-decoration: none;
            font-family: 'Inter', sans-serif;
            transition: background-color 0.3s ease;
        }
        .whatsapp-button:hover {
            background-color: #880e4f; /* Darker red on hover */
        }
        .whatsapp-button img {
            vertical-align: middle;
            margin-right: 8px;
            height: 20px;
        }
        @media print {
            body {
                background-color: white;
            }
            .no-print {
                display: none;
            }
            .sidebar {
                display: none;
            }
            .container {
                display: block;
            }
            .main-content {
                display: block;
                width: 100%;
            }
            .calc-section {
                box-shadow: none;
                border: none;
            }
        }
    </style>
</head>
<body>

<!-- Top Header -->
<div class="no-print text-center text-[15px] font-bold text-[#FF0000] p-2 bg-white rounded-lg mx-auto mb-4 max-w-full">
    by Anurag Rai | ‚òé 9340726600 | üõ† Technical Support Consultant
</div>

<div class="p-4 sm:p-6 lg:p-8">
    <h1 class="text-3xl sm:text-4xl font-bold text-center mb-6 text-indigo-800">üèóÔ∏è ‡§™‡•ç‡§≤‡•â‡§ü ‡§ï‡•ç‡§∑‡•á‡§§‡•ç‡§∞‡§´‡§≤ ‡§î‡§∞ ‡§≤‡§æ‡§ó‡§§ ‡§ï‡•à‡§≤‡§ï‡•Å‡§≤‡•á‡§ü‡§∞</h1>
    
    <!-- Export/Print Button -->
    <div class="no-print text-center mb-4">
        <button id="printBtn" class="bg-indigo-500 text-white px-6 py-2 rounded-lg shadow-md hover:bg-indigo-600 transition-colors">
            üñ®Ô∏è Print / Export PDF
        </button>
    </div>

    <div class="container mx-auto">
        <div class="sidebar no-print">
            <h2>‡§á‡§®‡§™‡•Å‡§ü ‡§™‡•à‡§∞‡§æ‡§Æ‡•Ä‡§ü‡§∞‡•ç‡§∏</h2>
            <div class="mb-4">
                <label for="rateFull" class="block text-sm font-medium text-gray-700">‡§™‡•ç‡§∞‡§§‡§ø ‡§µ‡§∞‡•ç‡§ó ‡§´‡•Å‡§ü ‡§¶‡§∞ (‡§™‡•Ç‡§∞‡•Ä)</label>
                <input type="number" id="rateFull" value="300" class="w-full rounded-lg border border-gray-300 p-2 mt-1">
            </div>

            <h3 class="font-bold text-lg text-gray-800 border-b pb-2 mb-4">‡§Æ‡•Ç‡§≤ ‡§™‡•ç‡§≤‡•â‡§ü ‡§µ‡§ø‡§µ‡§∞‡§£</h3>
            <div class="mb-4">
                <label for="initialLength" class="block text-sm font-medium text-gray-700">‡§∂‡•Å‡§∞‡•Å‡§Ü‡§§‡•Ä ‡§≤‡§Ç‡§¨‡§æ‡§à (ft)</label>
                <input type="number" id="initialLength" value="50" class="w-full rounded-lg border border-gray-300 p-2 mt-1">
            </div>
            <div class="mb-4">
                <label for="initialWidth" class="block text-sm font-medium text-gray-700">‡§∂‡•Å‡§∞‡•Å‡§Ü‡§§‡•Ä ‡§ö‡•å‡§°‡§º‡§æ‡§à (ft)</label>
                <input type="number" id="initialWidth" value="30" class="w-full rounded-lg border border-gray-300 p-2 mt-1">
            </div>

            <h3 class="font-bold text-lg text-gray-800 border-b pb-2 mb-4">‡§Ö‡§§‡§ø‡§∞‡§ø‡§ï‡•ç‡§§ ‡§™‡•ç‡§≤‡•â‡§ü ‡§ï‡•ç‡§∑‡•á‡§§‡•ç‡§∞</h3>
            <div class="space-y-4" id="dynamic-inputs-container">
                <!-- Dynamic input fields will be added here -->
            </div>

            <div class="mt-6 flex items-center gap-2">
                <select id="addItemSelect" class="flex-grow rounded-lg border border-gray-300 p-2">
                    <option value="balcony">Add Balcony Plot Area</option>
                    <option value="cantilever">Add Cantilever Plot Area</option>
                    <option value="slab">Add Slab Plot Area</option>
                    <option value="lintel">Add Lintel beam Plot Area</option>
                    <option value="stair">Add Step Stair Plot Area</option>
                    <option value="beamfoot">Add Beam Foot Plot Area</option>
                    <option value="other">Add Other Plot Area</option>
                    <option value="plot1">Add Plot 1</option>
                    <option value="plot2">Add Plot 2</option>
                </select>
                <button id="addItemBtn" class="bg-blue-500 text-white px-4 py-2 rounded-lg shadow-md hover:bg-blue-600 transition-colors">+</button>
            </div>
        </div>

        <div class="main-content">
            <div class="calc-section flex-1">
                <h2>Area Calculation Summary</h2>
                <table class="w-full text-sm">
                    <thead>
                        <tr>
                            <th>‡§Ü‡§á‡§ü‡§Æ</th>
                            <th>‡§≤‡§Ç‡§¨‡§æ‡§à (ft)</th>
                            <th>‡§ö‡•å‡§°‡§º‡§æ‡§à (ft)</th>
                            <th>‡§ï‡•ç‡§∑‡•á‡§§‡•ç‡§∞‡§´‡§≤ (sq.ft)</th>
                            <th>‡§Ö‡§Ç‡§§‡§∞ (sq.ft)</th>
                        </tr>
                    </thead>
                    <tbody id="area-summary-body">
                        <!-- Data will be inserted here -->
                    </tbody>
                </table>
            </div>

            <div class="calc-section flex-1">
                <h2>Details Summary (Cost)</h2>
                <table class="w-full text-sm">
                    <thead>
                        <tr>
                            <th>‡§Ü‡§á‡§ü‡§Æ</th>
                            <th>‡§™‡•Ç‡§∞‡•Ä ‡§∞‡§æ‡§∂‡§ø</th>
                            <th>‡§Ü‡§ß‡•Ä ‡§∞‡§æ‡§∂‡§ø</th>
                            <th>‡§™‡•ç‡§∞‡§§‡§ø ‡§µ‡§∞‡•ç‡§ó ‡§´‡•Å‡§ü ‡§¶‡§∞</th>
                        </tr>
                    </thead>
                    <tbody id="cost-summary-body">
                        <!-- Data will be inserted here -->
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>

<!-- Bottom Footer -->
<div class="no-print mt-8 p-4 bg-gray-100 rounded-lg text-center">
    <a class="whatsapp-button" href="https://wa.me/919340726600?text=Hello%2C%20I%20need%20assistance%20regarding%20the%20plot%20area%20calculator." target="_blank">
        <img src="https://img.icons8.com/color/48/000000/whatsapp.png" alt="WhatsApp Icon">
        Need Help? WhatsApp: 9340726600
    </a>
    <p class="text-xs text-gray-500 mt-2">üì© Auto WhatsApp Message | <span class="text-red-500">* Terms & Conditions apply *</span></p>
</div>


<script>
    document.addEventListener('DOMContentLoaded', () => {

        // Get all input elements and attach a single event listener for changes
        document.querySelectorAll('input[type="number"]').forEach(input => {
            input.addEventListener('input', updateAllCalculations);
        });

        // Add a new item when the button is clicked
        document.getElementById('addItemBtn').addEventListener('click', () => {
            const selectedItem = document.getElementById('addItemSelect').value;
            addDynamicInput(selectedItem);
        });

        // Print/Export button functionality
        document.getElementById('printBtn').addEventListener('click', () => {
            window.print();
        });


        // Helper function to format numbers with commas and decimals
        const formatNumber = (value, decimals = 2) => {
            if (isNaN(value)) return '0.00';
            return (value || 0).toLocaleString('en-IN', { minimumFractionDigits: decimals, maximumFractionDigits: decimals });
        };

        // Helper function to format currency
        const formatCurrency = (value) => {
            if (isNaN(value)) return '‚Çπ0.00';
            return new Intl.NumberFormat('en-IN', { style: 'currency', currency: 'INR' }).format(value || 0);
        };

        let itemIdCounter = 0; // Counter for unique IDs for new items

        // Function to add a new dynamic input section
        const addDynamicInput = (itemType) => {
            const container = document.getElementById('dynamic-inputs-container');
            const itemId = `item-${itemIdCounter++}`;
            
            // Get the display name and default values for the new item
            let displayName;
            let defaultLength = 0;
            let defaultWidth = 0;
            
            switch (itemType) {
                case 'balcony':
                    displayName = 'Add Balcony Plot Area';
                    defaultLength = 4;
                    defaultWidth = 4;
                    break;
                case 'cantilever':
                    displayName = 'Add Cantilever Plot Area';
                    defaultLength = 1;
                    defaultWidth = 1;
                    break;
                case 'slab':
                    displayName = 'Add Slab Plot Area';
                    defaultLength = 0;
                    defaultWidth = 0;
                    break;
                case 'lintel':
                    displayName = 'Add Lintel beam Plot Area';
                    defaultLength = 0;
                    defaultWidth = 0;
                    break;
                case 'stair':
                    displayName = 'Add Step Stair Plot Area';
                    defaultLength = 0;
                    defaultWidth = 0;
                    break;
                case 'beamfoot':
                    displayName = 'Add Beam Foot Plot Area';
                    defaultLength = 0;
                    defaultWidth = 0;
                    break;
                case 'plot1':
                    displayName = 'Add Plot 1';
                    defaultLength = 1;
                    defaultWidth = 1;
                    break;
                case 'plot2':
                    displayName = 'Add Plot 2';
                    defaultLength = 1;
                    defaultWidth = 1;
                    break;
                default: // For 'other'
                    displayName = 'Add Other Plot Area';
                    defaultLength = 0;
                    defaultWidth = 0;
                    break;
            }

            const newItemDiv = document.createElement('div');
            newItemDiv.id = itemId;
            newItemDiv.className = 'border-t pt-4 mt-4';
            newItemDiv.innerHTML = `
                <div class="flex justify-between items-center mb-2">
                    <span class="font-semibold text-gray-800">${displayName}</span>
                    <button class="remove-btn text-red-500 hover:text-red-700 text-sm" data-id="${itemId}">‡§π‡§ü‡§æ‡§è‡§Ç</button>
                </div>
                <div class="mb-2">
                    <label class="block text-sm text-gray-600">‡§≤‡§Ç‡§¨‡§æ‡§à (ft)</label>
                    <input type="number" class="w-full rounded-lg border p-2 dynamic-length" data-id="${itemId}" value="${defaultLength}">
                </div>
                <div class="mb-2">
                    <label class="block text-sm text-gray-600">‡§ö‡•å‡§°‡§º‡§æ‡§à (ft)</label>
                    <input type="number" class="w-full rounded-lg border p-2 dynamic-width" data-id="${itemId}" value="${defaultWidth}">
                </div>
            `;
            container.appendChild(newItemDiv);

            // Add event listeners to the new input fields and the remove button
            newItemDiv.querySelectorAll('input').forEach(input => {
                input.addEventListener('input', updateAllCalculations);
            });
            newItemDiv.querySelector('.remove-btn').addEventListener('click', (e) => {
                const targetId = e.target.getAttribute('data-id');
                document.getElementById(targetId).remove();
                updateAllCalculations(); // Recalculate after removing an item
            });

            updateAllCalculations(); // Recalculate after adding a new item
        };
        
        // The main function to perform all calculations and update the UI
        function updateAllCalculations() {
            // --- 1. Read all input values ---
            const rateFull = parseFloat(document.getElementById('rateFull').value) || 0;
            const rateHalf = rateFull / 2; // Automatically calculate half rate
            const initialLength = parseFloat(document.getElementById('initialLength').value) || 0;
            const initialWidth = parseFloat(document.getElementById('initialWidth').value) || 0;
            const initialArea = initialLength * initialWidth;
            
            // --- 2. Dynamically get all additional plot areas ---
            const dynamicInputs = document.querySelectorAll('#dynamic-inputs-container > div');
            const dynamicData = [];
            dynamicInputs.forEach(item => {
                const itemTypeSpan = item.querySelector('span').textContent;
                let itemType;
                if (itemTypeSpan.includes('Balcony')) {
                    itemType = 'Balcony';
                } else if (itemTypeSpan.includes('Cantilever')) {
                    itemType = 'Cantilever';
                } else if (itemTypeSpan.includes('Slab')) {
                    itemType = 'Slab';
                } else if (itemTypeSpan.includes('Lintel')) {
                    itemType = 'Lintel beam';
                } else if (itemTypeSpan.includes('Stair')) {
                    itemType = 'Step Stair';
                } else if (itemTypeSpan.includes('Beam Foot')) {
                    itemType = 'Beam Foot';
                } else if (itemTypeSpan.includes('Plot 1')) {
                    itemType = 'Plot 1';
                } else if (itemTypeSpan.includes('Plot 2')) {
                    itemType = 'Plot 2';
                } else {
                    itemType = 'Other';
                }
                
                const length = parseFloat(item.querySelector('.dynamic-length').value) || 0;
                const width = parseFloat(item.querySelector('.dynamic-width').value) || 0;
                
                dynamicData.push({
                    itemType,
                    length,
                    width,
                });
            });

            // --- 3. Perform Area Calculations and build Area Table HTML ---
            let areaSummaryHtml = `
                <tr>
                    <td>Building/built-up Plot Area</td>
                    <td>${formatNumber(initialLength, 2)}</td>
                    <td>${formatNumber(initialWidth, 2)}</td>
                    <td>${formatNumber(initialArea, 2)}</td>
                    <td>-</td>
                </tr>
            `;
            let runningLength = initialLength;
            let runningWidth = initialWidth;
            let previousArea = initialArea;

            // Store area differences for cost calculation
            const costCalculationData = [];

            dynamicData.forEach((item, index) => {
                const diffLength = item.length;
                const diffWidth = item.width;
                
                runningLength += diffLength;
                runningWidth += diffWidth;
                
                const currentTotalArea = runningLength * runningWidth;
                const areaDifference = currentTotalArea - previousArea;
                previousArea = currentTotalArea;

                costCalculationData.push({
                    itemType: item.itemType,
                    diffArea: areaDifference
                });

                areaSummaryHtml += `
                    <tr>
                        <td><b class="text-[#b71c1c]">${item.itemType}</b></td>
                        <td>+${formatNumber(diffLength, 2)}</td>
                        <td>+${formatNumber(diffWidth, 2)}</td>
                        <td>-</td>
                        <td>${formatNumber(areaDifference, 2)}</td>
                    </tr>
                    <tr class="total-row">
                        <td><i class="text-[#b71c1c]">Total Plot Area ${index + 1}</i></td>
                        <td>${formatNumber(runningLength, 2)}</td>
                        <td>${formatNumber(runningWidth, 2)}</td>
                        <td>${formatNumber(currentTotalArea, 2)}</td>
                        <td>-</td>
                    </tr>
                `;
            });
            
            const finalArea = runningLength * runningWidth;

            areaSummaryHtml += `
                <tr class="final-total-row">
                    <td><i>Final Plot Area</i></td>
                    <td>${formatNumber(runningLength, 2)}</td>
                    <td>${formatNumber(runningWidth, 2)}</td>
                    <td>${formatNumber(finalArea, 2)}</td>
                    <td>-</td>
                </tr>
            `;
            document.getElementById('area-summary-body').innerHTML = areaSummaryHtml;

            // --- 4. Perform Cost Calculations and build Cost Table HTML ---
            let costSummaryHtml = `
                <tr>
                    <td>Building/built-up Plot Area</td>
                    <td>${formatCurrency(initialArea * rateFull)}</td>
                    <td>${formatCurrency(initialArea * rateHalf)}</td>
                    <td>${formatNumber(rateFull, 0)}</td>
                </tr>
            `;
            let grandTotalFull = initialArea * rateFull;
            let grandTotalHalf = initialArea * rateHalf;

            costCalculationData.forEach(item => {
                // ‡§™‡•Å‡§∞‡•Ä ‡§∞‡§æ‡§∂‡§ø (Full Amount): ‡§Ö‡§Ç‡§§‡§∞ * ‡§™‡•Ç‡§∞‡•Ä ‡§¶‡§∞
                const fullCost = item.diffArea * rateFull;
                // ‡§Ü‡§ß‡•Ä ‡§∞‡§æ‡§∂‡§ø (Half Amount): ‡§Ö‡§Ç‡§§‡§∞ * ‡§Ü‡§ß‡•Ä ‡§¶‡§∞ (‡§ú‡•ã ‡§Ö‡§¨ ‡§∏‡•ç‡§µ‡§ö‡§æ‡§≤‡§ø‡§§ ‡§π‡•à)
                const halfCost = item.diffArea * rateHalf;
                
                grandTotalFull += fullCost;
                grandTotalHalf += halfCost;

                costSummaryHtml += `
                    <tr>
                        <td><b class="text-[#b71c1c]">${item.itemType}</b></td>
                        <td>${formatCurrency(fullCost)}</td>
                        <td>${formatCurrency(halfCost)}</td>
                        <td>${formatNumber(rateHalf, 0)}</td>
                    </tr>
                `;
            });
            costSummaryHtml += `
                <tr class="total-row">
                    <td><b class="text-[#b71c1c]">GRAND TOTAL</b></td>
                    <td>${formatCurrency(grandTotalFull)}</td>
                    <td>${formatCurrency(grandTotalHalf)}</td>
                    <td>-</td>
                </tr>
            `;
            document.getElementById('cost-summary-body').innerHTML = costSummaryHtml;
        }

        // Add initial items on load. These lines were removed based on user request.
        // addDynamicInput('balcony');
        // addDynamicInput('cantilever');
        
        // Initial calculation on page load
        updateAllCalculations();
    });
</script>
</body>
</html>
